# Synthor
## Links
Deployed app: https://jltyler.github.io/synthor-front

Deployed API: https://peaceful-wildwood-37664.herokuapp.com

API repo: https://github.com/jltyler/synthor-api

## What is this?
Synthor is a simple synthesizer that utilizes the Web Audio API to generate audio signals for playback. 2 oscillators can be utilized to generate the original waveform. Both of these oscillators feed into a 12dB lowpass filter. Patches (settings) can be saved to and loaded from a back end. You can load any patches you did not create provided they are not set to private patches.

![Synthor Screenshot](https://dl.dropboxusercontent.com/s/sm8xz31h13wp2ne/Synthor%20Screenshot.png)

## Usage
### General
Change settings on the two oscillators to set up a couple basic waveforms.

Use the lowpass filter settings to modify the output.

Click notes on the virtual keyboard at the bottom to play your patch.

Use your QWERTY keyboard to play notes. ASDF row plays the white notes and QWERTY row plays the black notes.

Save patches to the backend so you can load them later or elsewhere.
### Oscillator controls
- Volume: The overall gain of the oscillator
- Octave: Lower or raise the octave
- Detune: Detune up or down in cents (1200 = one octave higher)
- Wavform: The waveform generated by the oscillator
- Unison: Overlays and slightly detunes several oscillators
- Panning: Pan the oscillator to the left or right channel
- Tremolo: Type of waveform to use for the tremolo effect
- Amplitude: How far up and down the waveform frequency is modulated (note that this is in actual frequency not cents)
- Frequency: How fast the tremolo oscillator oscillates
- Attack: Seconds until gain reaches full gain after a key is pressed
- Decay: Seconds until gain drops to sustain level
- Sustain: Where to sustain the gain when a key is held.
- Release: Seconds until gain drops to nothing after key is released
### Filter controls
- Cutoff: Initial cutoff frequency for lowpass filter
- Q: Attenuates signal at the frequency cutoff
- Env: Frequency that the filter envelope will add
- Tremolo: Type of waveform to use for the tremolo effect
- Amplitude: How far up and down the filter cutoff frequency is modulated
- Frequency: How fast the tremolo oscillator oscillates
- Attack: Seconds until cutoff frequency peaks at Cutoff + Env after a key is pressed
- Decay: Seconds until cutoff drops to sustain level
- Sustain: Sustains at Cutoff + Env * Sustain while key is held
- Release: Seconds until cutoff drops back to Cutoff levels after key is released

## Installation
After cloning use `npm install` to install dependencies.

Then use `grunt serve` to host a local server at `localhost:7165`

## Technologies used
THe front end app is written in HTML5 and javascript while utilizing jQuery and Handlebars. The knobs to control the settings come from the [jQuery knob library](https://github.com/aterrien/jQuery-Knob). The synthesizer engine uses the [Web Audio API](https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API) to generate the audio signals and play them back. The virtual keyboard is generated from the [Qwerty Hancock](https://stuartmemo.com/qwerty-hancock/) library.

## Approach
I mapped out the synth engine before anything else. Getting a good idea for how to write it, I began coding. I started by writing a basic synth engine that only supported a single oscillator. I then wrote the code for the filter settings and hooked the oscillator into it. After getting that to work I generalized the oscillator into a Voice class to be reused for multiple oscillators.

I then worked out how to structure the page layout and the controls. I came across the jQuery knob library which provided a very nice UI to change values for the synth while also giving the layout a nicer look.

After a basic layout was done I worked on getting CRUD actions working to persist the patch data to the back end. I worked on the authorization CRUD first and gave it a temporary layout. Then I worked on the actual patches actions and similarily gave the patch action section a temporary layout.

After getting CRUD actions to work I finalized the UI and styling and added a sorting feature to the patch index while also separating the patches owned by the user from the publicly listed patches.

And of course when I needed a small break I jammed out on the synth and made some cool noises with it.

## Planned features and current issues
- Mobile works but the keyboard pushes off the screen
- Tremolo controls affect the frequency absolutely. I wnat to add a knob to allow relative control measured in cents
- Delay settings to get some cool echo effects
- Distortion effect
- Reverb effect
- Different filters
- Controls for unison spread range
- Saving and loading oscillators as a separate entity to allow mixing and matching with greater ease
- MIDI integration to allow an external MIDI device to play notes through the synth engine

## User Stories
As a user, I can change 2 to 3 separate oscillator settings to produce varied waveforms

As a user, I can change filter settings to manipulate those waveforms

As a user, I can change envelope settings on the gain and filter

As a user, I can save oscillator settings and filter settings independently and reuse them

As a user, I can save my patches to a database to retrieve later

As.a user, I can save private patches that no one else can load

As a user, I can play notes with my patch on a visual keyboard or the physical keyboard


## Wireframes
Main: https://wireframe.cc/xw2anL

Osc: https://wireframe.cc/zUPe1I

Filter: https://wireframe.cc/2uiU0q

Load: https://wireframe.cc/5Dpjpd
